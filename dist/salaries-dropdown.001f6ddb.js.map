{"version":3,"sources":["scripts/salaries-dropdown.js"],"names":["stateFields","Y0","yScale","d3","csv","require","error","data","salaryMap","forEach","d","state","Year","field","push","makeVis","margin","top","right","bottom","left","width","height","xScale","scale","ordinal","domain","rangeRoundBands","linear","range","canvas","select","append","attr","xAxis","svg","axis","orient","call","selectAll","style","yAxis","yAxisHandleForUpdate","text","updateBars","bars","enter","i","rangeBand","Math","abs","transition","duration","exit","remove","dropdownChange","newState","property","newData","salaries","Object","keys","sort","dropdown","insert","on","initialData"],"mappings":"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","file":"salaries-dropdown.001f6ddb.js","sourceRoot":"../src","sourcesContent":["var stateFields = ['Alabama',\n'Alaska',\n'Arizona',\n'Arkansas',\n'California',\n'Colorado',\n'Connecticut',\n'Delaware',\n'DC',\n'Florida',\n'Georgia',\n'Hawaii',\n'Idaho',\n'Illinois',\n'Indiana',\n'Iowa',\n'Kansas',\n'Kentucky',\n'Louisiana',\n'Maine',\n'Maryland',\n'Massachusetts',\n'Michigan',\n'Minnesota',\n'Mississippi',\n'Missouri',\n'Montana',\n'Nebraska',\n'Nevada',\n'New Hampshire',\n'New Jersey',\n'New Mexico',\n'New York',\n'North Carolina',\n'North Dakota',\n'Ohio',\n'Oklahoma',\n'Oregon',\n'Pennsylvania',\n'Rhode Island',\n'South Carolina',\n'South Dakota',\n'Tennessee',\n'Texas',\n'Utah',\n'Vermont',\n'Virginia',\n'Washington',\n'West Virginia',\n'Wisconsin',\n'Wyoming'];\n\nfunction Y0() {\n    return yScale(0);\n  }\n\n\nd3.csv(require('/data/total-salaries.csv'), function(error, data) {\n\n    var salaryMap = {};\n    data.forEach(function(d) {\n        var state = d.Year;\n        salaryMap[state] = [];\n\n        stateFields.forEach(function(field) {\n            salaryMap[state].push( +d[field] );\n        });\n    });\n    makeVis(salaryMap);\n});\n\nvar makeVis = function(salaryMap) {\n    // Define dimensions of vis\n    var margin = { top: 30, right: 30, bottom: 30, left: 30 },\n        width  = 800 - margin.left - margin.right,\n        height = 600 - margin.top  - margin.bottom;\n\n    // Make x scale\n    var xScale = d3.scale.ordinal()\n        .domain(stateFields)\n        .rangeRoundBands([0, width], 0.1);\n\n    // Make y scale, the domain will be defined on bar update\n    var yScale = d3.scale.linear()\n        .domain([-20, 30])\n        .range([height, 0]);\n\n    // Create canvas\n    var canvas = d3.select(\"#vis-container\")\n      .append(\"svg\")\n        .attr(\"width\",  width  + margin.left + margin.right)\n        .attr(\"height\", height + margin.top  + margin.bottom)\n      .append(\"g\")\n        .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n    // Make x-axis and add to canvas\n    var xAxis = d3.svg.axis()\n        .scale(xScale)\n        .orient(\"bottom\");\n\n    canvas.append(\"g\")\n        .attr(\"class\", \"x axis\")\n        .attr(\"transform\", \"translate(0,\" + yScale(0) + \")\")\n        .call(xAxis)\n        .selectAll(\"text\")\t\n        .style(\"text-anchor\", \"end\")\n        .style(\"alignment-baseline\", 'start')\n        .style(\"font-size\", 9)\n        .attr(\"dx\", \"-.8em\")\n        .attr(\"dy\", function(d) { return d < 0 ? 7:-7})\n        .attr(\"transform\", \"rotate(-90)\");\n\n    // Make y-axis and add to canvas\n    var yAxis = d3.svg.axis()\n        .scale(yScale)\n        .orient(\"left\");\n\n    var yAxisHandleForUpdate = canvas.append(\"g\")\n        .attr(\"class\", \"y axis\")\n        .call(yAxis)\n        .selectAll(\"text\")\t\n        .style(\"text-anchor\", \"end\")\n        .style(\"alignment-baseline\", 'start')\n        .style(\"font-size\", 10);\n        // .attr(\"dx\", \"-.8em\")\n        // .attr(\"dy\", function(d) { return d < 0 ? 7:-7})\n        // .attr(\"transform\", \"rotate(-90)\");\n\n    yAxisHandleForUpdate.append(\"text\")\n        .attr(\"transform\", \"rotate(-90)\")\n        .attr(\"y\", 6)\n        .attr(\"dy\", \".71em\")\n        .style(\"text-anchor\", \"end\")\n        .style(\"font-size\", 10)\n        .text(\"Percent change\");\n\n    var updateBars = function(data) {\n\n        yAxisHandleForUpdate.call(yAxis);\n\n        var bars = canvas.selectAll(\".bar\").data(data);\n\n        // Add bars for new data\n        bars.enter()\n          .append(\"rect\")\n            .attr(\"class\", \"bar\")\n            .attr(\"x\", function(d,i) { return xScale( stateFields[i] ); })\n            .attr(\"width\", xScale.rangeBand())\n            .attr(\"y\", function(d, i) { return d < 0 ? yScale(0) : yScale(d); })\n            .attr(\"height\", function(d, i) { return Math.abs( yScale(d) - yScale(0) ); });\n       \n\n        // Update old ones, already have x / width from before\n        bars\n            .transition().duration(250)\n            .attr(\"y\", function(d, i) { return d < 0 ? yScale(0) : yScale(d); })\n            .attr(\"height\", function(d, i) { return Math.abs( yScale(d) - yScale(0) ); });\n\n        // Remove old ones\n        bars.exit().remove();\n    };\n\n    // Handler for dropdown value change\n    var dropdownChange = function() {\n        var newState = d3.select(this).property('value'),\n            newData   = salaryMap[newState];\n\n        updateBars(newData);\n    };\n\n    var salaries = Object.keys(salaryMap).sort();\n\n    var dropdown = d3.select(\"#vis-container\")\n        .insert(\"select\", \"svg\")\n        .on(\"change\", dropdownChange);\n\n    dropdown.selectAll(\"option\")\n        .data(salaries)\n      .enter().append(\"option\")\n        .attr(\"value\", function (d) { return d; })\n        .text(function (d) {    \n            return d\n        });\n\n    var initialData = salaryMap[ salaries[0] ];\n    updateBars(initialData);\n};\n"]}