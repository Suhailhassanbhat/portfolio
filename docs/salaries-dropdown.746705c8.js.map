{"version":3,"sources":["scripts/salaries-dropdown.js"],"names":["stateFields","Y0","yScale","d3","csv","require","error","data","salaryMap","forEach","d","state","Year","field","push","makeVis","margin","width","height","xScale","scale","ordinal","domain","rangeRoundBands","linear","range","canvas","select","append","attr","xAxis","svg","axis","orient","call","selectAll","style","yAxis","yAxisHandleForUpdate","text","updateBars","bars","enter","i","rangeBand","Math","abs","transition","duration","exit","remove","salaries","Object","keys","sort","insert","on","newState","property","newData","initialData"],"mappings":"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","file":"salaries-dropdown.746705c8.js","sourceRoot":"../src","sourcesContent":["var stateFields = ['Alabama',\n'Alaska',\n'Arizona',\n'Arkansas',\n'California',\n'Colorado',\n'Connecticut',\n'Delaware',\n'DC',\n'Florida',\n'Georgia',\n'Hawaii',\n'Idaho',\n'Illinois',\n'Indiana',\n'Iowa',\n'Kansas',\n'Kentucky',\n'Louisiana',\n'Maine',\n'Maryland',\n'Massachusetts',\n'Michigan',\n'Minnesota',\n'Mississippi',\n'Missouri',\n'Montana',\n'Nebraska',\n'Nevada',\n'New Hampshire',\n'New Jersey',\n'New Mexico',\n'New York',\n'North Carolina',\n'North Dakota',\n'Ohio',\n'Oklahoma',\n'Oregon',\n'Pennsylvania',\n'Rhode Island',\n'South Carolina',\n'South Dakota',\n'Tennessee',\n'Texas',\n'Utah',\n'Vermont',\n'Virginia',\n'Washington',\n'West Virginia',\n'Wisconsin',\n'Wyoming'];\n\nfunction Y0() {\n    return yScale(0);\n  }\n\n\nd3.csv(require('/data/total-salaries.csv'), function(error, data) {\n\n    var salaryMap = {};\n    data.forEach(function(d) {\n        var state = d.Year;\n        salaryMap[state] = [];\n\n        stateFields.forEach(function(field) {\n            salaryMap[state].push( +d[field] );\n        });\n    });\n    makeVis(salaryMap);\n});\n\nvar makeVis = function(salaryMap) {\n    // Define dimensions of vis\n    var margin = { top: 30, right: 30, bottom: 30, left: 30 },\n        width  = 800 - margin.left - margin.right,\n        height = 600 - margin.top  - margin.bottom;\n\n    // Make x scale\n    var xScale = d3.scale.ordinal()\n        .domain(stateFields)\n        .rangeRoundBands([0, width], 0.1);\n\n    // Make y scale, the domain will be defined on bar update\n    var yScale = d3.scale.linear()\n        .domain([-20, 30])\n        .range([height, 0]);\n\n    // Create canvas\n    var canvas = d3.select(\"#vis-container\")\n      .append(\"svg\")\n        .attr(\"width\",  width  + margin.left + margin.right)\n        .attr(\"height\", height + margin.top  + margin.bottom)\n      .append(\"g\")\n        .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n    // Make x-axis and add to canvas\n    var xAxis = d3.svg.axis()\n        .scale(xScale)\n        .orient(\"bottom\");\n\n    canvas.append(\"g\")\n        .attr(\"class\", \"x axis\")\n        .attr(\"transform\", \"translate(0,\" + yScale(0) + \")\")\n        .call(xAxis)\n        .selectAll(\"text\")\t\n        .style(\"text-anchor\", \"end\")\n        .style(\"alignment-baseline\", 'start')\n        .style(\"font-size\", 9)\n        .attr(\"dx\", \"-.8em\")\n        .attr(\"dy\", function(d) { return d < 0 ? 7:-7})\n        .attr(\"transform\", \"rotate(-90)\");\n\n    // Make y-axis and add to canvas\n    var yAxis = d3.svg.axis()\n        .scale(yScale)\n        .orient(\"left\");\n\n    var yAxisHandleForUpdate = canvas.append(\"g\")\n        .attr(\"class\", \"y axis\")\n        .call(yAxis)\n        .selectAll(\"text\")\t\n        .style(\"text-anchor\", \"end\")\n        .style(\"alignment-baseline\", 'start')\n        .style(\"font-size\", 10);\n        // .attr(\"dx\", \"-.8em\")\n        // .attr(\"dy\", function(d) { return d < 0 ? 7:-7})\n        // .attr(\"transform\", \"rotate(-90)\");\n\n    yAxisHandleForUpdate.append(\"text\")\n        .attr(\"transform\", \"rotate(-90)\")\n        .attr(\"y\", 6)\n        .attr(\"dy\", \".71em\")\n        .style(\"text-anchor\", \"end\")\n        .style(\"font-size\", 10)\n        .text(\"Percent change\");\n\n    var updateBars = function(data) {\n\n        yAxisHandleForUpdate.call(yAxis);\n\n        var bars = canvas.selectAll(\".bar\").data(data);\n\n        // Add bars for new data\n        bars.enter()\n          .append(\"rect\")\n            .attr(\"class\", \"bar\")\n            .attr(\"x\", function(d,i) { return xScale( stateFields[i] ); })\n            .attr(\"width\", xScale.rangeBand())\n            .attr(\"y\", function(d, i) { return d < 0 ? yScale(0) : yScale(d); })\n            .attr(\"height\", function(d, i) { return Math.abs( yScale(d) - yScale(0) ); });\n       \n\n        // Update old ones, already have x / width from before\n        bars\n            .transition().duration(250)\n            .attr(\"y\", function(d, i) { return d < 0 ? yScale(0) : yScale(d); })\n            .attr(\"height\", function(d, i) { return Math.abs( yScale(d) - yScale(0) ); });\n\n        // Remove old ones\n        bars.exit().remove();\n    };\n\n    // Handler for dropdown value change\n    var dropdownChange = function() {\n        var newState = d3.select(this).property('value'),\n            newData   = salaryMap[newState];\n\n        updateBars(newData);\n    };\n\n    var salaries = Object.keys(salaryMap).sort();\n\n    var dropdown = d3.select(\"#vis-container\")\n        .insert(\"select\", \"svg\")\n        .on(\"change\", dropdownChange);\n\n    dropdown.selectAll(\"option\")\n        .data(salaries)\n      .enter().append(\"option\")\n        .attr(\"value\", function (d) { return d; })\n        .text(function (d) {    \n            return d\n        });\n\n    var initialData = salaryMap[ salaries[0] ];\n    updateBars(initialData);\n};\n"]}